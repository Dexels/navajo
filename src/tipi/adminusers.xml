<?xml version="1.0" encoding="UTF-8"?>
<tid errorhandler="error">
    <tipi class="dialog" closable="false" h="200" icon="{resource:/tipi/tipi-icon-small.png}" maximizable="false"
        modal="true" name="userAdmin" resizable="true" title="'Wachtwoord wijzigen'" w="450">
        <tipi-instance class="messagestore" name="postUpdate" service="vla/ProcessVLAUpdateUser">
            <event type="onLoad">
                <action type="performTipiMethod">
                    <param name="path" value="{tipi://init/desktop/userAdmin}"/>
                    <param name="name" value="'dispose'"/>
                </action>
                <action type="showInfo">
                    <param name="text" value="'Wachtwoord is gewijzigd'"/>
                </action>
            </event>
        </tipi-instance>
        <tipi-instance class="messagestore" name="postInsert" service="vla/ProcessVLAInsertUser">
            <event type="onLoad">
                <action type="performTipiMethod">
                    <param name="path" value="{tipi://init/desktop/userAdmin}"/>
                    <param name="name" value="'dispose'"/>
                </action>
                <action type="showInfo">
                    <param name="text" value="'Gebruiker toegevoegd'"/>
                </action>
            </event>
        </tipi-instance>
        <layout type="border">
            <tipi-instance border="{border:/titled- Wijzigen wachtwoord}" class="tipi" constraint="center"
                id="userAdmin" service="vla/InitVLAInsertUser">
                <layout type="table">
                    <tr>
                        <td left="5" right="5" weighty="0">
                            <component-instance class="property" id="Username" propertyname="'/UserData/Username'"/>
                        </td>
                    </tr>
                    <tr>
                        <td left="5" right="5" weighty="0">
                            <component-instance class="property" id="PreviousPassword" propertyname="'/UserData/PreviousPassword'"/>
                        </td>
                    </tr>
                    <tr>
                        <td left="5" right="5" weighty="0">
                            <component-instance class="property" id="Password" propertyname="'/UserData/Password'"/>
                        </td>
                    </tr>
                    <tr>
                        <td left="5" right="5" weighty="0">
                            <component-instance class="property" id="PasswordCheck" propertyname="'/UserData/PasswordCheck'"/>
                        </td>
                    </tr>
                    <tr>
                        <td right="5" weightx="0" weighty="0">
                            <component-instance class="button" id="change" name="ChangeButton" text="'Wijzigen'" tooltip="'Wijzig password'">
                                <event type="onActionPerformed">
                                    <condition>
                                        <param name="tipipath" value="tipi:/.."/>
                                        <param name="expression" value="[/UserData/HasDefinedUser] == true"/>
                                        <action type="performMethod">
                                            <param name="tipipath" value="{tipi:/..}"/>
                                            <param name="method" value="'vla/ProcessVLAUpdateUser'"/>
                                        </action>
                                        <action type="setValue">
                                            <param name="from" value="{attribute://init/desktop/userAdmin/userAdmin/Password:propertyValue}"/>
                                            <param name="to" value="{propertyref://init/desktop/query:.:/UserData/Password}"/>
                                        </action>
                                    </condition>
                                    <condition>
                                        <param name="tipipath" value="tipi:/.."/>
                                        <param name="expression" value="[/UserData/HasDefinedUser] == false"/>
                                        <action type="performMethod">
                                            <param name="tipipath" value="{tipi:/..}"/>
                                            <param name="method" value="'vla/ProcessVLAInsertUser'"/>
                                        </action>
                                        <action type="setValue">
                                            <param name="from" value="{attribute://init/desktop/userAdmin/userAdmin/Username:propertyValue}"/>
                                            <param name="to" value="{propertyref://init/desktop/query:.:/UserData/Username}"/>
                                        </action>
                                        <action type="setValue">
                                            <param name="from" value="{attribute://init/desktop/userAdmin/userAdmin/Password:propertyValue}"/>
                                            <param name="to" value="{propertyref://init/desktop/query:.:/UserData/Password}"/>
                                        </action>
                                    </condition>
                                </event>
                            </component-instance>
                        </td>
                    </tr>
                    <tr>
                        <td right="5" weightx="1" weighty="1">
                            <component-instance class="hidden" id="hidden1"/>
                        </td>
                    </tr>
                </layout>
                <event type="onLoad">
                    <action type="performTipiMethod">
                        <param name="path" value="{tipi://init/desktop/userAdmin}"/>
                        <param name="name" value="'show'"/>
                    </action>
                    <action type="debug">
                        <param name="value" value="[/UserData/HasDefinedUser]"/>
                    </action>
                    <condition>
                        <param name="tipipath" value="tipi:/."/>
                        <param name="expression" value="[/UserData/HasDefinedUser] == false"/>
                        <action type="setValue">
                            <param name="from" value="false"/>
                            <param name="to" value="{attributeref://init/desktop/userAdmin/userAdmin/PreviousPassword:enabled}"/>
                        </action>
                        <action type="setValue">
                            <param name="from" value="'Toevoegen'"/>
                            <param name="to" value="{attributeref://init/desktop/userAdmin/userAdmin/change:text}"/>
                        </action>
                    </condition>
                </event>
            </tipi-instance>
        </layout>
    </tipi>
</tid>
