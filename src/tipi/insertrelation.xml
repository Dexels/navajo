<?xml version="1.0" encoding="UTF-8"?>
<tid errorhandler="error" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="tipiscript.xsd">
  <tipi class="dialog" h="550" icon="{resource:/tipi/tipi-icon-small.png}" modal="true"
    name="insertRelationFrame" service="vla/ProcessVLAInsertRelation;vla/InitVLAInsertMember"
    title="'Nieuwe Relatie'" w="800">
    <event type="onInstantiate">
      <action type="performMethod">
        <param name="tipipath" value="{tipi://init/messagestore}"/>
        <param name="method" value="'vla/InitVLAInsertMember'"/>
      </action>
      <action type="performMethod">
        <param name="tipipath" value="{tipi:/.}"/>
        <param name="method" value="'vla/ProcessVLAInsertRelation'"/>
      </action>
      <action type="performTipiMethod">
        <param name="path" value="{tipi:/.}"/>
        <param name="name" value="'show'"/>
      </action>
    </event>
    <event type="onGeneratedErrors"/>
    <layout type="table">
      <tr>
        <td colspan="4" weightx="1" weighty="1">
          <tipi-instance class="tabs" name="tabs">
            <!-- Persondata tab -->
            <tipi-instance class="tipi" constraint="Persoon" name="insertPersonData" prefix="/MemberData">
              <layout type="table">
                <tr>
                  <td colspan="2">
                    <tipi-instance border="{border:/titled- Persoonsgegevens}" class="tipi"
                      name="personPersonData" prefix="/MemberData">
                      <layout type="table">
                        <tr>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance capitalization="firstupper" class="property" name="LastName"/>
                          </td>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance class="property" name="Infix"/>
                          </td>
                          <td weighty="0">
                            <component-instance class="hidden" id="hidden1"/>
                          </td>
                        </tr>
                        <tr>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance capitalization="firstupper" class="property" name="FirstName"/>
                          </td>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance capitalization="upper" class="property" name="Initials">
                              <event type="onFocusGained">
                                <action type="setValue">
                                  <param name="to" value="{attributeref://init/desktop/insertRelationFrame/tabs/insertPersonData/personPersonData/Initials:propertyValue}"/>
                                  <param name="from" value="GetInitials({property://init/desktop/insertRelationFrame/tabs/insertPersonData:.:/MemberData/FirstName})"/>
                                </action>
                              </event>
                            </component-instance>
                          </td>
                          <td weighty="0">
                            <component-instance class="hidden" id="hidden1"/>
                          </td>
                        </tr>
                        <tr>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance class="property" name="Gender"/>
                          </td>
                          <td colspan="2" weighty="0">
                            <component-instance class="hidden" id="hidden1"/>
                          </td>
                        </tr>
                        <tr>
                          <td left="5" weighty="0">
                            <component-instance class="property" name="DateOfBirth"/>
                          </td>
                          <!--<td colspan="2" left="5" weighty="0">
                            <component-instance class="property" name="BirthPlace"  capitalization="upper"/>
                          </td>-->
                        </tr>
                        <!--<tr>
                          <td colspan="1" left="5" weightx="0" weighty="0">
                            <component-instance class="property" name="BirthCountryCode"/>
                          </td>
                        </tr>-->
                      </layout>
                    </tipi-instance>
                  </td>
                </tr>
                <tr>
                  <td colspan="2">
                    <tipi-instance border="{border:/titled- Adresgegevens}" class="tipi"
                      name="personAddressData" prefix="/MemberData">
                      <layout type="table">
                        <tr>
                          <td colspan="2" left="5" weightx="0" weighty="0">
                            <component-instance capitalization="firstupper" class="property" name="BusinessName"/>
                          </td>
                        </tr>
                        <tr>
                          <td colspan="2" left="5" weighty="0">
                            <component-instance class="property" name="StreetName"/>
                          </td>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance class="property" name="AddressNumber"/>
                          </td>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance class="property" name="AddressNumberAppendix"/>
                          </td>
                        </tr>
                        <tr>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance capitalization="upper" class="property" name="ZipCode"/>
                          </td>
                          <td colspan="2" left="5" weighty="0">
                            <component-instance capitalization="upper" class="property" name="City"/>
                          </td>
                        </tr>
                        <tr>
                          <td colspan="2" left="5" weightx="0" weighty="0">
                            <component-instance class="property" name="AddressCountryCode"/>
                          </td>
                        </tr>
                      </layout>
                    </tipi-instance>
                  </td>
                </tr>
                <tr>
                  <td>
                    <tipi-instance border="{border:/titled- Contactgegevens}" class="tipi"
                      name="personContactData" prefix="/MemberData">
                      <layout type="table">
                        <tr>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance class="property" name="TelephoneNumber"/>
                          </td>
                        </tr>
                        <tr>
                          <td left="5" weighty="0">
                            <component-instance class="property" name="MobileNumber"/>
                          </td>
                        </tr>
                        <tr>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance class="property" name="FaxNumber"/>
                          </td>
                        </tr>
                      </layout>
                    </tipi-instance>
                  </td>
                  <td>
                    <tipi-instance border="{border:/titled- Financiele gegevens}" class="tipi"
                      name="personFinancialData" prefix="/MemberData">
                      <layout type="table">
                        <tr>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance class="property" name="BankAccountType"/>
                          </td>
                        </tr>
                        <tr>
                          <td left="5" weighty="0">
                            <component-instance class="property" name="BankAccountNumber">
                              <event type="onFocusLost">
                                <condition>
                                  <param name="tipipath" value="tipi:/.."/>
                                  <param name="expression" value="Trim([/MemberData/AscriptionPlace]) == ''"/>
                                  <action type="setValue">
                                    <param name="to" value="{attributeref:/../AscriptionPlace:propertyValue}"/>
                                    <param name="from" value="{property://init/desktop/insertRelationFrame/tabs/insertPersonData:.:/MemberData/ZipCode}+' '+{property://init/desktop/insertRelationFrame/tabs/insertPersonData:.:/MemberData/City}"/>
                                  </action>
                                </condition>
                                <condition>
                                  <param name="tipipath" value="tipi:/.."/>
                                  <param name="expression" value="Trim([/MemberData/Ascription]) == ''"/>
                                  <action type="setValue">
                                    <param name="to" value="{attributeref:/../Ascription:propertyValue}"/>
                                    <param name="from" value="{property://init/desktop/insertRelationFrame/tabs/insertPersonData:.:/MemberData/Initials}+' '+{property://init/desktop/insertRelationFrame/tabs/insertPersonData:.:/MemberData/LastName}"/>
                                  </action>
                                </condition>
                              </event>
                            </component-instance>
                          </td>
                        </tr>
                        <tr>
                          <td colspan="1" left="5" weighty="0">
                            <component-instance capitalization="upper" class="property" name="Ascription"/>
                          </td>
                        </tr>
                        <tr>
                          <td left="5" weightx="0" weighty="0">
                            <component-instance capitalization="upper" class="property" name="AscriptionPlace"/>
                          </td>
                        </tr>
                      </layout>
                    </tipi-instance>
                  </td>
                </tr>
              </layout>
            </tipi-instance>
          </tipi-instance>
        </td>
      </tr>
      <tr>
        <td colspan="2" weightx="1" weighty="0">
          <component-instance class="hidden" id="hidden1"/>
        </td>
        <td weightx="0" weighty="0">
          <component-instance class="button" icon="{resource:/tipi/ok.png}" name="memberOkButton" tooltip="'Opslaan relatie'">
            <event type="onActionPerformed">
              <action type="setValue">
                <param name="from" value="{property://init/messagestore:.:/Club/ClubIdentifier}"/>
                <param name="to" value="{propertyref://init/desktop/mainFrameSearch/SearchCriteria:.:/Club/ClubIdentifier}"/>
              </action>
              <action type="setValue">
                <param name="from" value="{property://init/messagestore:.:/Club/ClubIdentifier}"/>
                <param name="to" value="{propertyref://init/desktop/insertRelationFrame:.:/Club/ClubIdentifier}"/>
              </action>
              <action type="setValue">
                <param name="to" value="{propertyref://init/desktop/insertRelationFrame:.:/MemberData/isClubRelation}"/>
                <param name="from" value="true"/>
              </action>
              <action type="performMethod">
                <param name="tipipath" value="{tipi://init/desktop/insertRelationFrame}"/>
                <param name="method" value="'vla/ProcessVLAInsertRelation'"/>
              </action>
              <action type="performTipiMethod">
                <param name="path" value="{tipi://init/desktop/insertRelationFrame}"/>
                <param name="name" value="'dispose'"/>
              </action>
            </event>
          </component-instance>
        </td>
        <td weightx="0" weighty="0">
          <component-instance class="button" icon="{resource:/tipi/cancel.png}"
            name="memberCancelButton" tooltip="'Annuleren'">
            <event type="onActionPerformed">
              <action type="performTipiMethod">
                <param name="path" value="{tipi://init/desktop/insertRelationFrame}"/>
                <param name="name" value="'dispose'"/>
              </action>
            </event>
          </component-instance>
        </td>
      </tr>
    </layout>
  </tipi>
</tid>
