<?xml version="1.0" encoding="UTF-8"?>
<tid errorhandler="error">
    <tipi class="dialog" closable="false" h="100" icon="{resource:/tipi/tipi-icon-small.png}" maximizable="false" modal="true" name="codeTableMigrateWindow" resizable="true" title="'Ophalen code tabellen'" w="400">
        <layout type="border">
            <tipi-instance class="tipi" constraint="center" name="migrateCodeTableScreen" service="vla/InitMigrateOrganization">
                <layout type="table">
                    <tr>
                        <td colspan="4" weighty="0">
                            <component-instance class="progressbar" name="downloadProgress" orientation="horizontal"/>
                        </td>
                    </tr>
                    <tr>
                        <td left="5">
                            <component-instance class="label" font="{font:/Arial-12-1}" name="downloadStatus" text="'Druk op start om de codetabellen op te halen'"/>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4" weightx="0" weighty="0">
                            <component-instance class="button" name="migrateCodeTableButton" text="'Start'">
                                <event type="onActionPerformed">
                                    <action type="performMethod">
                                        <param name="tipipath" value="{tipi://init/desktop/query}"/>
                                        <param name="method" value="'vla/InitMigrateCodeTables'"/>
                                    </action>
                                    <action type="setValue">
                                        <param name="to" value="{attributeref://init/desktop/codeTableMigrateWindow/migrateCodeTableScreen/downloadStatus:text}"/>
                                        <param name="from" value="'Bezig met ophalen stamtabellen'"/>
                                    </action>
                                    <action type="setValue">
                                        <param name="to" value="{attributeref://init/desktop/codeTableMigrateWindow/migrateCodeTableScreen/downloadProgress:value}"/>
                                        <param name="from" value="15"/>
                                    </action>
                                    <action type="setValue">
                                        <param name="to" value="{attributeref://init/desktop/codeTableMigrateWindow/migrateCodeTableScreen/downloadProgress:indeterminate}"/>
                                        <param name="from" value="false"/>
                                    </action>
                                </event>
                            </component-instance>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <component-instance class="hidden" id="hidden1"/>
                        </td>
                    </tr>
                </layout>
            </tipi-instance>
        </layout>
        <tipi-instance class="messagestore" id="dummy1" name="dummy1" service="vla/InitMigrateCodeTables" visible="false">
            <event type="onGeneratedErrors">
                <action type="debug">
                    <param name="value" value="'ERRRROOOOOOOOOOOOOOOR'"/>
                </action>
                <action type="performTipiMethod">
                    <param name="path" value="{tipi://init/desktop/codeTableMigrateWindow}"/>
                    <param name="name" value="'hide'"/>
                </action>
                <action type="instantiate">
                    <param name="id" value="'certificateWindow'"/>
                    <param name="name" value="'certificateWindow'"/>
                    <param name="location" value="{component://init/desktop}"/>
                    <param name="force" value="true"/>
                </action>
                <action type="performTipiMethod">
                    <param name="path" value="{tipi://init/desktop/certificateWindow}"/>
                    <param name="name" value="'show'"/>
                </action>
            </event>
            <event type="onLoad">
                <action type="setValue">
                    <param name="to" value="{attributeref://init/desktop/codeTableMigrateWindow/migrateCodeTableScreen/downloadProgress:value}"/>
                    <param name="from" value="60"/>
                </action>
                <action type="performMethod">
                    <param name="tipipath" value="{tipi://init/desktop/query}"/>
                    <param name="method" value="'vla/ProcessMigrateOrganization'"/>
                </action>
                <action type="setValue">
                    <param name="to" value="{attributeref://init/desktop/codeTableMigrateWindow/migrateCodeTableScreen/downloadStatus:text}"/>
                    <param name="from" value="'Bezig met migreren organisatie'"/>
                </action>
            </event>
        </tipi-instance>
        <tipi-instance class="messagestore" id="dummy2" name="dummy2" service="vla/ProcessMigrateOrganization" visible="false">
            <event type="onGeneratedErrors">
                <action type="debug">
                    <param name="value" value="'ERRRROOOOOOOOOOOOOOOR'"/>
                </action>
            </event>
            <event type="onLoad">
                <action type="setValue">
                    <param name="to" value="{attributeref://init/desktop/codeTableMigrateWindow/migrateCodeTableScreen/downloadProgress:value}"/>
                    <param name="from" value="100"/>
                </action>
                <action type="setValue">
                    <param name="to" value="{attributeref://init/desktop/codeTableMigrateWindow/migrateCodeTableScreen/downloadStatus:text}"/>
                    <param name="from" value="'Gereed, leden worden ingeladen'"/>
                </action>
                <action type="setValue">
                    <param name="from" value="{property://init/messagestore:.:/Club/ClubIdentifier}"/>
                    <param name="to" value="{propertyref://init/desktop/mainFrameSearch/SearchCriteria:.:/Club/ClubIdentifier}"/>
                </action>
                <action type="performMethod">
                    <param name="tipipath" value="{tipi://init/desktop/mainFrameSearch/SearchCriteria}"/>
                    <param name="method" value="'vla/ProcessVLASearchMembers'"/>
                </action>
                <action type="performTipiMethod">
                    <param name="path" value="{tipi://init/desktop/codeTableMigrateWindow}"/>
                    <param name="name" value="'dispose'"/>
                </action>
                <action type="performMethod">
                    <param name="tipipath" value="{tipi://init/desktop/query}"/>
                    <param name="method" value="'vla/ProcessVLAQueryContributionProfiles'"/>
                </action>
            </event>
        </tipi-instance>
    </tipi>
</tid>
