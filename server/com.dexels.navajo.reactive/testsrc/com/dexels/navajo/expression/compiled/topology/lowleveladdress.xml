<joins>
	<direct>
      <store topic="sportlinkkernel-ADDRESS">
          <formatzipcode field="zipcode"/>
          <remove name="updateby"/>
          <remove name="lastupdate"/>
      </store>
      <groupedStore name="addressbyzipcode" from="sportlinkkernel-ADDRESS" key="zipcode">
          <remove name="updateby"/>
          <remove name="lastupdate"/>
    </groupedStore>
    
    	<joinGrouped name="addresswithposition" from="addressbyzipcode" with="sportlinkkernel-ZIPCODEPOSITION" bypass="validZip:zipcode"
      into="Coordinates"  optional="true">
    </joinGrouped>
    
    
    <groupedStore name="addressbycommunityid" from="sportlinkkernel-POSTCODETABLE" key="communityid">
        <remove name="updateby"/>
        <remove name="lastupdate"/>
        <remove name="unipostcodereeksindicatie"/>
        <remove name="huisnrtot"/>
        <remove name="straatnaam"/>
        <remove name="huisnrvan"/>
        <remove name="woonplaats"/>
    </groupedStore>
    <joinGrouped name="postcodetablewithcommunity"
      from="addressbycommunityid" with="sportlinkkernel-COMMUNITY" columns="communityname"/>

    <groupedStore name="addresswithpositiongrouped" from="addresswithposition" key="zipcode" />
    <groupedStore name="postcodetablewithcommunitygrouped" from="postcodetablewithcommunity" key="postcode" />
    <joinGrouped name="addresswithcommunity"
      from="addresswithpositiongrouped"
      flatten="true"
      withList="postcodetablewithcommunitygrouped"
      optional="true"
      into="Community"
      columns="communityname"
      to="@ADDRESS"/>
	</direct>
</joins>