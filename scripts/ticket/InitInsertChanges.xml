<?xml version="1.0" encoding="UTF-8"?>
<tsl author="Erik" id="ticket/InitInsertTicket" notes="" repository="$Id$" xmlns="http://www.dexels.com/navascript" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.dexels.com/navascript http://www.dexels.com/schema/navascript.xsd ">
    <methods>
        <method name="ticket/ProcessInsertChanges">
            <required message="Ticket" />
        </method>
    </methods>
    <message name="Changes">
          <property name="TicketTreat" type="selection" direction="in">
            <option name="-" value="-1" />
        </property>
        <map object="com.dexels.navajo.adapter.SQLMap">
            <field name="datasource"> 
                <expression value="'ticket'" />
            </field>
            <field name="query">
            <expression xml:space="preserve">
                SELECT tickettreatid, notificationcontent FROM tickettreat
            </expression>
            </field>
            <property name="TicketTreat" type="selection" direction="in">
                <map ref="resultSet">
                    <property name="name">
                        <expression value="$columnValue('tickettreatid') + ' - ' +$columnValue('notificationcontent')" />
                    </property>
                    <property name="value">
                        <expression value="$columnValue('tickettreatid')" />
                    </property>
                </map>
            </property>
        </map>
        
 

        <property name="ChangeName" type="string" direction="in" />
        <property name="ChangePath" type="string" direction="in" />
        <property name="ChangeServer" type="string" direction="in" />

        
        <!-- Select initial (sub)category -->  
        <property name="Category" type="selection" direction="in">
            <option name="-" value="-1"  />
        </property>        
        <map object="com.dexels.navajo.adapter.SQLMap">
            <field name="datasource">
                <expression value="'ticket'" />
            </field>
            <field name="query">
                <expression xml:space="preserve">
                SELECT categoryid, categoryname, subcategoryname FROM category order by categoryname
            </expression>
            </field>
            <property name="Category" type="selection" direction="in">
                <map ref="resultSet">
                    <property name="name">
                        <expression value="$columnValue('categoryname') + ' ' +$columnValue('subcategoryname')" />
                    </property>
                    <property name="value">
                        <expression value="$columnValue('categoryid')" />
                    </property>
                </map>
            </property>
        </map>
       </message> 
</tsl>